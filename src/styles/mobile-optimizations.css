/* Mobile Optimizations - Consolidated & Optimized */

@media (max-width: 768px) {
  /* === GLOBAL MOBILE SAFETY === */
  
  /* Prevent horizontal scroll globally */
  body, html {
    overflow-x: hidden !important;
    max-width: 100vw !important;
    box-sizing: border-box !important;
  }

  * {
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  /* Global responsive images */
  img {
    max-width: 100% !important;
    height: auto !important;
  }

  /* === TEXT OPTIMIZATION === */
  
  /* Text wrapping and readability */
  .mobile-text-wrap, .mobile-text-wrap * {
    word-wrap: break-word !important;
    word-break: break-word !important;
    hyphens: auto !important;
    overflow-wrap: break-word !important;
  }

  /* Minimum font sizes for readability - using design tokens */
  p, span, div, li, td, th {
    font-size: var(--font-size-sm) !important;
    line-height: var(--line-height-normal) !important;
  }

  .text-xs, .text-sm {
    font-size: var(--font-size-sm) !important;
  }

  /* === LAYOUT OPTIMIZATION === */
  
  /* Single column grids */
  .mobile-grid-1 .grid,
  .mobile-grid-1.grid {
    grid-template-columns: 1fr !important;
    gap: var(--spacing-4) !important;
  }

  /* Safe containers - reduced padding to fix 16px overflow */
  .mobile-container-safe {
    width: 100%;
    max-width: 100vw;
    padding-left: var(--spacing-3);
    padding-right: var(--spacing-3);
    margin: 0 auto;
    box-sizing: border-box;
  }

  /* Card containers */
  .mobile-card-safe {
    width: 100% !important;
    max-width: calc(100vw - var(--spacing-8)) !important;
    margin: 0 auto !important;
    box-sizing: border-box !important;
  }

  /* === INTERACTIVE ELEMENTS === */

  /* Smart Touch targets - Only apply when explicitly requested to avoid conflicts */
  .mobile-touch-optimize,
  .mobile-touch-optimize button:not(.btn-design-system),
  .mobile-touch-optimize .btn:not(.btn-design-system),
  [role="button"].mobile-touch-target,
  .touch-target {
    min-height: var(--touch-target-min);
    min-width: var(--touch-target-min);
  }

  /* Legacy touch targets - fallback for unoptimized elements */
  button:not([class*="btn-"]):not([class*="Button"]),
  [role="button"]:not([class*="btn-"]) {
    min-height: 44px;
    min-width: 44px;
  }

  /* Specific touch targets for different element types */
  .touch-target-small {
    min-height: 40px !important;
    min-width: 40px !important;
  }

  .touch-target-large {
    min-height: 48px !important;
    min-width: 48px !important;
  }

  /* Navigation links and menu items */
  nav a, .nav-link, [role="menuitem"] {
    min-height: 48px !important;
    display: flex !important;
    align-items: center !important;
    padding: var(--spacing-3) var(--spacing-4) !important;
  }

  /* Input elements - enhanced for better touch */
  input, select, textarea, .input {
    min-height: 48px !important;
    padding: var(--spacing-3) var(--spacing-4) !important;
    font-size: 16px !important; /* Prevent iOS zoom */
    width: 100% !important;
    box-sizing: border-box !important;
    border-radius: var(--radius-md) !important;
  }

  /* Checkbox and radio buttons - larger click area */
  input[type="checkbox"], input[type="radio"] {
    min-width: 20px !important;
    min-height: 20px !important;
    margin: var(--spacing-2) !important;
  }

  /* Label click area for checkboxes/radios */
  label:has(input[type="checkbox"]), 
  label:has(input[type="radio"]) {
    min-height: 44px !important;
    display: flex !important;
    align-items: center !important;
    padding: var(--spacing-2) !important;
    cursor: pointer !important;
  }

  /* Mobile buttons - enhanced (opt-in only) */
  .mobile-button-full,
  .mobile-button-full button,
  .mobile-button-full .btn {
    width: 100%;
    min-height: 48px;
    white-space: normal;
    word-wrap: break-word;
    text-align: center;
  }

  /* Smart mobile button wrapper - only applies styling when explicitly requested */
  .mobile-button-wrapper {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-2);
  }

  .mobile-button-wrapper button,
  .mobile-button-wrapper .btn {
    width: 100%;
    min-height: 48px;
  }

  /* Icon buttons - smart touch targets (less aggressive) */
  .mobile-icon-button,
  button[class*="icon"]:not(.btn-design-system),
  .btn-icon:not(.btn-design-system) {
    min-width: 44px;
    min-height: 44px;
  }

  /* Legacy icon buttons fallback */
  button:has(svg):not(:has(span)):not([class*="btn-"]):not([class*="Button"]) {
    min-width: 44px;
    min-height: 44px;
    padding: var(--spacing-2);
  }

  /* Dropdown and select triggers */
  .select-trigger, [role="combobox"] {
    min-height: 48px !important;
    padding: var(--spacing-2) var(--spacing-4) !important;
  }

  /* Tab navigation */
  [role="tab"], .tab-trigger {
    min-height: 44px !important;
    min-width: 44px !important;
    padding: var(--spacing-2) var(--spacing-4) !important;
  }

  /* Cards and interactive areas */
  .card:hover, .card[role="button"], a .card {
    min-height: 64px !important;
    padding: var(--spacing-4) !important;
  }

  /* === TOUCH TARGET SPACING === */

  /* Prevent cramped layouts - opt-in spacing for touch targets */
  .mobile-touch-spacing button + button,
  .mobile-touch-spacing .btn + .btn,
  .mobile-touch-spacing a + a {
    margin-left: var(--spacing-2);
    margin-top: var(--spacing-2);
  }

  /* Smart button group spacing */
  .mobile-button-group {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-2);
  }

  .mobile-button-group--horizontal {
    flex-direction: row;
    flex-wrap: wrap;
  }

  /* Form element spacing */
  form .space-y-4 > * + * {
    margin-top: var(--spacing-4) !important;
  }

  form .space-y-6 > * + * {
    margin-top: var(--spacing-6) !important;
  }

  /* Button group spacing - less aggressive */
  .mobile-button-group-legacy {
    gap: var(--spacing-2);
  }

  .mobile-button-group-legacy button,
  .mobile-button-group-legacy .btn {
    min-width: calc(50% - var(--spacing-1));
  }

  /* Modern button group (preferred) */
  .button-group-mobile {
    display: flex;
    gap: var(--spacing-2);
    flex-wrap: wrap;
  }

  .button-group-mobile > * {
    flex: 1;
    min-width: 120px;
  }

  /* Navigation spacing */
  nav ul li + li {
    margin-top: var(--spacing-1) !important;
  }

  /* List item spacing for touch */
  ul li, ol li {
    min-height: 32px !important;
    padding: var(--spacing-1) 0 !important;
  }

  /* Interactive list items */
  ul li a, ol li a, .list-item[role="button"] {
    min-height: 44px !important;
    padding: var(--spacing-2) var(--spacing-3) !important;
    display: block !important;
  }

  /* === Z-INDEX & OVERLAYS === */
  
  /* Hero text overlays */
  .mobile-hero-container {
    position: relative !important;
    z-index: 45 !important;
  }

  .mobile-hero-container * {
    position: relative !important;
    z-index: 50 !important;
  }

  .mobile-text-overlay {
    position: relative !important;
    z-index: 30 !important;
  }

  /* === TEXT SHADOWS === */
  
  /* Standard text shadows */
  .mobile-text-shadow {
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7), 0 0 8px rgba(0, 0, 0, 0.3) !important;
  }

  /* Hero text shadows */
  .mobile-hero-text {
    text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.9), 0 0 12px rgba(0, 0, 0, 0.7), 0 0 20px rgba(0, 0, 0, 0.5) !important;
    position: relative !important;
    z-index: 50 !important;
  }

  /* === UTILITY CLASSES === */
  
  /* Prevent horizontal scroll utility */
  .no-horizontal-scroll {
    overflow-x: hidden !important;
    max-width: 100vw !important;
  }

  /* Additional overflow prevention for containers */
  .container {
    max-width: 100vw !important;
    padding-left: var(--spacing-3) !important;
    padding-right: var(--spacing-3) !important;
  }

  /* Responsive media container */
  .responsive-media img,
  .responsive-media video,
  .responsive-media iframe,
  .responsive-media svg,
  .responsive-media canvas {
    max-width: 100% !important;
    height: auto !important;
    object-fit: contain !important;
  }

  /* Flex wrapping */
  .mobile-flex-wrap .flex {
    flex-wrap: wrap !important;
  }

  .mobile-flex-safe .flex > * {
    min-width: 0 !important;
    flex-shrink: 1 !important;
  }

  /* === PERFORMANCE OPTIMIZATIONS === */
  
  /* GPU acceleration for smooth scrolling */
  .mobile-smooth-scroll {
    -webkit-overflow-scrolling: touch !important;
    scroll-behavior: smooth !important;
  }

  /* Optimized animations for mobile */
  .mobile-optimized-animation {
    will-change: transform !important;
    transform: translateZ(0) !important;
  }

  /* === FORM OPTIMIZATIONS === */
  
  /* Better form field spacing */
  .mobile-form-spacing .space-y-4 > * + * {
    margin-top: var(--spacing-4) !important;
  }

  .mobile-form-spacing .space-y-6 > * + * {
    margin-top: var(--spacing-6) !important;
  }

  /* Full width form controls */
  .mobile-form-full input,
  .mobile-form-full select,
  .mobile-form-full textarea,
  .mobile-form-full button {
    width: 100% !important;
  }

  /* === ACCESSIBILITY ENHANCEMENTS === */
  
  /* Larger focus indicators for mobile */
  .mobile-focus-enhanced:focus,
  .mobile-focus-enhanced:focus-visible {
    outline: 3px solid var(--color-primary-500) !important;
    outline-offset: var(--spacing-0-5) !important;
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .mobile-text-wrap {
      color: black !important;
      background: white !important;
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .mobile-optimized-animation {
      animation: none !important;
      transition: none !important;
    }
  }

  /* === TABLE RESPONSIVENESS === */
  
  /* Responsive tables */
  .mobile-table-responsive {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }

  .mobile-table-responsive table {
    min-width: 600px !important;
  }

  /* === DIALOG & MODAL OPTIMIZATIONS === */
  
  /* Full screen modals on mobile */
  .mobile-modal-full [role="dialog"] {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    max-width: none !important;
    max-height: none !important;
    border-radius: 0 !important;
    margin: 0 !important;
  }
}